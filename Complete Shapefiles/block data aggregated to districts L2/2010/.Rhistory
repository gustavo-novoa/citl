city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, existing_plan = agg_dists$distrct, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
?redist_map
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 1:10){
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city, 0, nchar(filenames_city)-7), "_plans.rds"))
}
rb_plans
?saveRDS
paste0(substr(filenames_city, 0, nchar(filenames_city)-7), "_plans.rds")
paste0(substr(filenames_city, 0, nchar(filenames_city)-7), "_plans.rds")
paste0(substr(filenames_city, 0, nchar(filenames_city[i])-7), "_plans.rds")
i
paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
i
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 2:10){
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 11:20){
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 14:40){
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 29:40){
if(i==29) #skip chicago
skip
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 29:40){
if(i==29) #skip chicago
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 29:40){
if(i==29) #skip chicago
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
i
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 35:40){
if(i==29)
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 35:40){
if(i==29)
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
filenames_city[40]
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 40:40){
if(i==29)
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
filenames_city[40]
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 41:50){
if(i==29)
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 51:60){
if(i==29)
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
filenames_city[52]
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 52:60){
if(i==29)
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
pop_tol
sum(agg_city$pop)
sum(agg_dists$pop)
sum(agg_dists$pop)/10
sum(agg_dists$pop)/11
(sum(agg_dists$pop)/11)*1.17
ndists
pop_tol
(sum(agg_dists$pop)/11)*.83
pop_tol
rb_plans<-redist_smc(city_map, nsims=1, ncores=parallel::detectCores(), runs=2)
pop_tol
sum(agg_dists$pop)
ndists
pop_tol
sum(agg_dists$pop)/11
(sum(agg_dists$pop)/11)*.34
(sum(agg_dists$pop)/11)*1.34
(sum(agg_dists$pop)/11)*1.35\
(sum(agg_dists$pop)/11)*1.35
?redist_smc
?redist_map
279,936-2
279936-196733
83203/196754
ndists
pop_tol
sum(city_map$pop)
sum(agg_dists$pop)/
sum(agg_dists$pop)
city<-st_read(filenames_city[i])
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
sum(city$pop)
sum(agg_dists$pop)
i
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 53:60){
if(i==29)
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 61:63){
if(i==29)
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 63:70){
if(i==29)
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 71:100){
if(i==29)
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
i
filenames_city[77]
library(dplyr)
library(redist)
library(sf)
year<-2010
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
filenames_city<-list.files(pattern="*.shp", full.names=FALSE) #Generate list of shapefiles
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_city <- list.files(pattern="*.shp", full.names=FALSE) #Generate list of aggregated cities
for(i in 77:100){
if(i==29)
next
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/blocks clipped to cities L2 data/2010")
city<-st_read(filenames_city[i])
city<-city%>%dplyr::select(pop, GEOID, NAME, geometry)
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/Complete Shapefiles/block data aggregated to districts L2/2010")
agg_dists<-st_read(agg_city[i])
pop_tol<-max(agg_dists$pop/(sum(agg_dists$pop)/(n_distinct(agg_dists$distrct)))-1)
ndists=n_distinct(agg_dists$distrct)
city_map<- redist::redist_map(city, pop_tol=pop_tol, ndists=ndists, total_pop=pop)
city_map$adj<-redist.adjacency(city_map)
rb_plans<-redist_smc(city_map, nsims=10000, ncores=parallel::detectCores(), runs=2)
print("sim complete")
setwd("/Users/gnovoa/Library/Mobile Documents/com~apple~CloudDocs/Documents/Coloring in the Lines/RR/RB simulated L2 plans")
saveRDS(rb_plans, file=paste0(substr(filenames_city[i], 0, nchar(filenames_city[i])-7), "_plans.rds"))
}
